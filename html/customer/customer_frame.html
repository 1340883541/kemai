<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>客户-主页</title>
    <script src="../../script/lib/rem.js"></script>
    <script src="../../script/lib/fastclick.js"></script>
    <link rel="stylesheet" type="text/css" href="../../css/lib/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/index/index.css" />
    <link rel="stylesheet" type="text/css" href="../../css/common.css" />
    <style>
        html,
        body,
        #wrap {
            height: 100%;
            background-color: #f7f7f7;
        }
    </style>
</head>

<body>
    <div id="wrap">
        <div class="filter-popup" ontouchstart="event.preventDefault();">
            <div class="filter-popbg"></div>
            <div class="filter-popbox">
                <ul>
                    <li>
                        <span>网络客户</span>
                        <i></i>
                    </li>
                    <li class="curr">
                        <span>渠道客户</span>
                        <i></i>
                    </li>
                    <li>
                        <span>销售客户</span>
                        <i></i>
                    </li>
                    <li>
                        <span>资源客户</span>
                        <i></i>
                    </li>
                </ul>
            </div>
        </div>
        <div class="filter-lists">
            <div class="filter-lis cfil-lis" @click="skipCustomerDetail">
                <div class="cfil-t flex-wrap flex-between">
                    <div class="cname">蔡丁</div>
                    <div class="cphone" @click="callPhone($event)"></div>
                </div>
                <div class="cfil-b">
                    <div class="cfil-bt lis"><i></i>客户类型: <span>短期</span></div>
                    <div class="cfil-gj time lis"><i></i>跟进时间: <span>2018/10/22</span></div>
                    <div class="cfil-jh time lis"><i></i>计划跟进: <span>2018/10/20</span></div>
                </div>
            </div>
            <div class="filter-lis cfil-lis" @click="skipCustomerDetail">
                <div class="cfil-t flex-wrap flex-between">
                    <div class="cname">孙京京</div>
                    <div class="cphone" @click="callPhone($event)"></div>
                </div>
                <div class="cfil-b">
                    <div class="cfil-bt lis"><i></i>客户类型: <span>长期</span></div>
                    <div class="cfil-gj time lis"><i></i>跟进时间: <span>2018/10/22</span></div>
                    <div class="cfil-jh time lis"><i></i>计划跟进: <span>2018/10/20</span></div>
                </div>
            </div>
            <div class="filter-lis cfil-lis" @click="skipCustomerDetail">
                <div class="cfil-t flex-wrap flex-between">
                    <div class="cname">王朔</div>
                    <div class="cphone" @click="callPhone($event)"></div>
                </div>
                <div class="cfil-b">
                    <div class="cfil-bt lis"><i></i>客户类型: <span>成交</span></div>
                    <div class="cfil-gj time lis"><i></i>跟进时间: <span>2018/10/22</span></div>
                    <div class="cfil-jh time lis"><i></i>计划跟进: <span>2018/10/20</span></div>
                </div>
            </div>
            <div class="filter-lis cfil-lis" @click="skipCustomerDetail">
                <div class="cfil-t flex-wrap flex-between">
                    <div class="cname">薛元元</div>
                    <div class="cphone" @click="callPhone($event)"></div>
                </div>
                <div class="cfil-b">
                    <div class="cfil-bt lis"><i></i>客户类型: <span>短期</span></div>
                    <div class="cfil-gj time lis"><i></i>跟进时间: <span>2018/10/22</span></div>
                    <div class="cfil-jh time lis"><i></i>计划跟进: <span>2018/10/20</span></div>
                </div>
            </div>
            <!-- 无更多数据 -->
            <div class="not-more-filter">没有更多数据</div>
        </div>
        <!-- 空页面 -->
        <empty-con :is-show="true" txt="暂无资源客户"></empty-con>
    </div>
</body>
<script type="text/javascript" src="../../script/lib/api.js"></script>
<script type="text/javascript" src="../../script/lib/jquery_3.1.1.min.js"></script>
<script type="text/javascript" src="../../script/lib/md5.js"></script>
<script type="text/javascript" src="../../script/lib/vue.min.js"></script>
<script type="text/javascript" src="../../script/lib/vue_lazyload.min.js"></script>
<script type="text/javascript" src="../../script/lib/api_ajax.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script>
    var cusV = null;
    apiready = function() {
        cusV = new Vue({
            el: '#wrap',
            data: {
                khClassList:[],
                khOriginList:[],
                search_cusName:'', // 搜索客户名
                search_source:'',  // 客户类型
                search_status:'',  // 客户类型
                order_followtime:0,     // 跟进时间
                order_nextfollow:0,     // 计划跟进时间
            },
            mounted: function() {
                this.fetchKhClass();
                this.fetchKhOrigin();
                this.fetchListData();
            },
            methods: {
                // 获取客户类型
                fetchKhClass:function(){
                    var _this = this;
                    wApiAjax({
                        url:'customer/sourceAndType',
                        header:{
                            token:'2323'
                        },
                        success:function(res){
                            if(res.code == 1){
                                _this.khClassList = res.data.customerSatauslist
                            }else{
                                wDialog.toast({
                                    msg:res.msg
                                })
                            }
                        }
                    })
                },
                // 获取客户来源
                fetchKhOrigin:function(){
                    var _this = this;
                    wApiAjax({
                        url:'customer/allSource',
                        header:{
                            token:'2323'
                        },
                        success:function(res){
                            if(res.code == 1){
                                _this.khOriginList = res.data.allsrorcelist
                            }else{
                                wDialog.toast({
                                    msg:res.msg
                                })
                            }
                        }
                    })
                },
                // 获取页面数据
                fetchListData:function(){
                    var _this = this;
                    wApiAjax({
                        url:'customer/datalist',
                        header:{
                            token:'2323'
                        },
                        data:{
                            employeeid:4,
                            search_cusName:_this.search_cusName,
                            search_source:_this.search_source,
                            search_status:_this.search_status,
                            order_followtime:_this.order_followtime,
                            order_nextfollow:_this.order_nextfollow,
                            pageNo:_this.pageNo,
                            pageSize:10,
                        },
                        success:function(){

                        }
                    });
                },
                // 跳转客户详情
                skipCustomerDetail: function() {
                    wHrefJs.openWin({
                        name: 'customerDetail',
                        path: './customer_detail.html',
                        param: {
                            cusId: 3
                        }
                    })
                },
                callPhone: function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    wDialog.toast({
                        msg: '拨打电话中，请注意接听'
                    })
                }
            }
        })

        api.setCustomRefreshHeaderInfo({
            bgColor: '#f7f7f7',
            isScale: true,
            image: {
                pull: [
                    'widget://image/loading_more.gif',
                    'widget://image/icon-loading40-2.png'
                ],
                load: [
                    'widget://image/loading_more.gif',
                    'widget://image/icon-loading40-2.png',
                    'widget://image/loading_more.gif',
                ]
            }
        }, function() {
            //下拉刷新被触发，自动进入加载状态，使用 api.refreshHeaderLoadDone() 手动结束加载中状态
            //下拉刷新被触发，使用 api.refreshHeaderLoadDone() 结束加载中状态
            // alert('开始加载刷新数据，摇一摇停止加载状态');
            setTimeout(function() {
                api.refreshHeaderLoadDone()
            }, 2000)
        });
    }
</script>

</html>
