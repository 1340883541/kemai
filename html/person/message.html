<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>个人中心-消息通知</title>
    <script src="../../script/lib/rem.js"></script>
    <script src="../../script/lib/fastclick.js"></script>
    <link rel="stylesheet" type="text/css" href="../../css/lib/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/person/message.css" />
</head>
<body>
    <!-- 头部 -->
  <div id="wrap">
      <div v-show="defult_show">
          <div class="header" id="header">
              <div class="back" @click="back"><img src="../../image/icon-dh-fanhui.png"></div>
              <div class="title">消息通知</div>
          </div>
              <div id="main" class="flex-con">
                  <div class="main_switch">
                      <div class="notice">通知</div>
                      <div class="weui-div" @click.stop="toggle">
                        <span class="weui-switch" :class="{'weui-switch-on' : me_checked}" :value="value" ></span>
                        <div v-if='!value' class="weui-div-2"></div>
                        <div v-if='value' class="weui-div-1"></div>
                      </div>
                  </div>
                  <div class="be_careful">注意：开启后可以单独设置接受消息类型</div>
             </div>
         </div>

          <!-- 列表 -->
          <div v-show="defult_hide">
              <div class="header" id="header">
                  <div class="back" @click="backGo"><img src="../../image/icon-dh-fanhui.png"></div>
                  <div class="title">消息通知</div>
              </div>
              <div id="main" class="flex-con">
                  <div class="mainSwitch">
                      <div class="notice">全部通知</div>
                      <div class="weui-div" @click.stop="toggleShow">
                        <span class="weui-switch" :class="{'weui-switch-on' : is_checked}" :value=valueKey ></span>
                        <div v-if='!valueKey' class="weui-div-2"></div>
                        <div v-if='valueKey' class="weui-div-1"></div>
                      </div>
                  </div>
                  <div v-show="show_info">
                      <div class="main_switch main_top">
                          <div class="notice">负责人变更</div>
                          <div class="weui-div" @click.stop="changeChenk(1)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[0]}" :value="arr[0]" ></span>
                            <div v-if='!arr[0]' class="weui-div-2"></div>
                            <div v-if='arr[0]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="mainSwitch">
                          <div class="notice">更近提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(2)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[1]}" :value="arr[1]" ></span>
                            <div v-if='!arr[1]' class="weui-div-2"></div>
                            <div v-if='arr[1]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="main_switch">
                          <div class="notice">回收提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(3)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[2]}" :value="arr[2]" ></span>
                            <div v-if='!arr[2]' class="weui-div-2"></div>
                            <div v-if='arr[2]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="mainSwitch">
                          <div class="notice">资源回收</div>
                          <div class="weui-div" @click.stop="changeChenk(4)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[3]}" :value="arr[3]" ></span>
                            <div v-if='!arr[3]' class="weui-div-2"></div>
                            <div v-if='arr[3]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="main_switch">
                          <div class="notice">认购提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(5)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[4]}" :value="arr[4]" ></span>
                            <div v-if='!arr[4]' class="weui-div-2"></div>
                            <div v-if='arr[4]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="main_switch">
                          <div class="notice">签约提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(6)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[5]}" :value="arr[5]" ></span>
                            <div v-if='!arr[5]' class="weui-div-2"></div>
                            <div v-if='arr[5]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="mainSwitch">
                          <div class="notice">缴费提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(7)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[6]}" :value="arr[6]" ></span>
                            <div v-if='! arr[6]' class="weui-div-2"></div>
                            <div v-if=' arr[6]' class="weui-div-1"></div>
                          </div>
                      </div>
                      <div class="main_switch">
                          <div class="notice">认购书提醒</div>
                          <div class="weui-div" @click.stop="changeChenk(8)">
                            <span class="weui-switch" :class="{'weui-switch-on' : arr[7]}" :value="arr[7]" ></span>
                            <div v-if='!arr[7]' class="weui-div-2"></div>
                            <div v-if='arr[7]' class="weui-div-1"></div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
     </div>
</body>
<script type="text/javascript" src="../../script/lib/api.js"></script>
<script type="text/javascript" src="../../script/lib/jquery_3.1.1.min.js"></script>
<script type="text/javascript" src="../../script/lib/fastclick.js"></script>
<script type="text/javascript" src="../../script/lib/md5.js"></script>
<script type="text/javascript" src="../../script/lib/swiper.min.js"></script>
<script type="text/javascript" src="../../script/lib/vue.min.js"></script>
<script type="text/javascript" src="../../script/lib/vue_lazyload.min.js"></script>
<script type="text/javascript" src="../../script/lib/api_ajax.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script>
    // apiready = function(){
    //     console.log('index')
    // }
    new Vue({
            el: '#wrap',
            data: {
              me_checked: this.value,
              defult_show:true,
              defult_hide:false,
              is_checked:this.valueKey,
              arr:[false],
              show_info:true,
            },
            props: {
              value: {
                type: Boolean,
                 default: true
              },
              valueKey:{
                  type: Boolean,
                 default: true
              },

            },
            watch: {
              value(){
                this.me_checked = this.value;
                this.is_checked =this.valueKey
              }
            },
            methods: {
                toggle() {
                       // 是否可点击
                         this.me_checked = true;
                         setTimeout(() => {
                          this.defult_hide = true;
                          this.defult_show=false;
                          this.arr=[true,true,true,true,true,true,true,true];
                          this.is_checked = true;
                        //   this.show_info = true;

                      },500);
                   },
                   changeChenk:function(num){
                       this.$set(this.arr,num-1,!this.arr[num-1])
                       this.is_checked=true;
                       this.chenked()
                   },
                     toggleShow(num){
                         if(!this.is_checked){
                           this.is_checked = true;
                           this.arr=[true,true,true,true,true,true,true,true]
                           this.show_info = true;
                    }else{
                         this.is_checked = false;
                         this.arr=[false,false,false,false,false,false,false,false];
                         this.show_info = false;
                    }
                },
                // 判断是否全选
                chenked:function(){
                    var isAllcheck = this.arr.indexOf(false,0);//是否全选
                    var isAllclose = this.arr.indexOf(true,0);//是否全部关闭
                    if(isAllcheck<0){
                           this.is_checked = true;
                    }else{
                        //  this.is_checked = true;
                        //  this.show_info=true;
                    }
                    if(isAllclose<0){
                          this.is_checked = false;
                          this.show_info=false;
                        //   this.defult_hide = false;
                        //   this.defult_show=true;
                        //   this.me_checked = false;
                    }
                },
                backGo:function(){
                    this.defult_hide =false;
                    this.defult_show= true
                },
                back:function(){
                    history.back(-1)
                }
            },

        })
</script>
</html>
