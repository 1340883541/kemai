<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- <meta http-equiv="Access-Control-Allow-Origin" content="https://192.168.0.214:8088"> -->
    <title>手机认证</title>
    <script src="../../script/lib/rem.js"></script>
    <script src="../../script/lib/fastclick.js"></script>
    <link rel="stylesheet" type="text/css" href="../../css/lib/api.css" />
    <link rel="stylesheet" type="text/css" href="../../css/login/phonerz.css" />
</head>

<body>
    <div id="wrap">
        <div class="header" id="header">
            <div class="back" @click="back"><img src="../../image/icon-dh-guanbi.png"></div>
        </div>
        <div id="main" class="flex-con">
            <div class="phone_authentication">手机认证</div>
            <div class="form-div">
                <div class="row flex-wrap flex-align">
                    <div class="input-box flex-con">
                        <input type="tel" maxlength="11" placeholder="请输入手机号" v-model="phone">
                        <div class="code">
                            <span v-html="obtain" v-show="default_obtain" @click="obtainClick"></span>
                            <span v-show="!default_obtain">重新发送({{count}}s)</span>
                        </div>
                    </div>
                </div>
                <div class="row flex-wrap flex-align">
                    <div class="input-box flex-con"><input type="text" maxlength="16" placeholder="请输入验证码" v-model="code"></div>
                </div>
                <div class="submit-btn space-between" @click="authentication">
                    <span class="text-align">认证</span>
                </div>
                <!-- <div> -->
            </div>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../script/lib/api.js"></script>
<script type="text/javascript" src="../../script/lib/jquery_3.1.1.min.js"></script>
<script type="text/javascript" src="../../script/lib/fastclick.js"></script>
<script type="text/javascript" src="../../script/lib/md5.js"></script>
<script type="text/javascript" src="../../script/lib/swiper.min.js"></script>
<script type="text/javascript" src="../../script/lib/vue.min.js"></script>
<script type="text/javascript" src="../../script/lib/speed-toast.js"></script>
<script type="text/javascript" src="../../script/lib/vue_lazyload.min.js"></script>
<script type="text/javascript" src="../../script/lib/api_ajax.js"></script>
<script type="text/javascript" src="data:application/octet-stream;base64,Ly8gLy8gdnVlIOaHkuWKoOi9vQ0KLy8gVnVlLnVzZShWdWVMYXp5bG9hZCwgew0KLy8gICAgIGVycm9yOiAnLi4vLi4vd2d0L2ltZ19sb2FkeEAyeC5qcGcnLA0KLy8gICAgIGxvYWRpbmc6ICcuLi8uLi93Z3QvaW1nX2xvYWR4QDJ4LmpwZycNCi8vIH0pOw0KLy8g5riF6ZmkIOenu+WKqOerr+eCueWHu+eahDMwMG1zIOW7tui/n++8jOeCuemAj+S6i+S7tg0KaWYgKCdhZGRFdmVudExpc3RlbmVyJyBpbiBkb2N1bWVudCkgew0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpIHsNCiAgICAgICAgLy8gRmFzdENsaWNrLmF0dGFjaChkb2N1bWVudC5ib2R5KTsNCiAgICB9LCBmYWxzZSk7DQp9Ow0KDQovLyDliKTmlq3mmK/lkKbnmbvlvZUNCmZ1bmN0aW9uIGNoZWNrTG9naW4oKSB7DQogICAgdmFyIGlzTG9naW4gPSB3UHJlZi5nZXRQcmVmcyh7DQogICAgICAgIGtleTogImlzTG9naW4iDQogICAgfSk7DQogICAgdmFyIHVzZXJJbmZvID0gd1ByZWYuZ2V0UHJlZnMoew0KICAgICAgICBrZXk6ICd1c2VySW5mbycNCiAgICB9KQ0KICAgIHJldHVybiAoaXNMb2dpbiA9PSAxICYmIHVzZXJJbmZvKSA/IHRydWUgOiBmYWxzZTsNCn07DQovLyDnqbrpobXpnaLlhazlhbHnu4Tku7YNCi8vIHR4dCA9PiDlhoXlrrkNClZ1ZS5jb21wb25lbnQoJ2VtcHR5LWNvbicsIHsNCiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9InctZW1wdHkiIHYtaWY9ImlzU2hvdyIgQHRvdWNoc3RhcnQ9InRvdWNoc3RhcnQoZXZlbnQpIj4nICsNCiAgICAgICAgJzxkaXYgY2xhc3M9InctZW1wdHktaW1nIj4nICsNCiAgICAgICAgJzxzbG90PjxpbWcgc3JjPSIuLi8uLi9pbWFnZS9pbWctd3VzaHVqdS5wbmciIGFsdD0iIj48L3Nsb3Q+JyArDQogICAgICAgICc8L2Rpdj4nICsNCiAgICAgICAgJzxkaXYgY2xhc3M9InctZW1wZXktdHh0IiB2LXRleHQ9InR4dCI+PC9kaXY+JyArDQogICAgICAgICc8L2Rpdj4nLA0KICAgIHByb3BzOiB7DQogICAgICAgIGlzU2hvdzogew0KICAgICAgICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHR4dDogew0KICAgICAgICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgICAgICAgZGVmYXVsdDogJycNCiAgICAgICAgfQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICB0b3VjaHN0YXJ0OiBmdW5jdGlvbihlKSB7DQogICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQogICAgfQ0KfSk7DQovLyDlho3mrKHlsIHoo4Ugb3BlbldpbiBvcGVuRnJhbWUNCi8vIOmhtemdoui3s+i9rA0KdmFyIHdIcmVmSnMgPSB7DQogICAgLy8g5YWz6Zet5b2T5YmN6aG16Z2iDQogICAgYmFja1dpbjogZnVuY3Rpb24oKSB7DQogICAgICAgIGFwaS5jbG9zZVdpbih7fSk7DQogICAgfSwNCiAgICAvLyDngrnlh7vov5Tlm54g5o6o6YCB5raI5oGvDQogICAgYmFja1dpblNlbmREYXRhOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgdGhpcy5zZW5kRXZlbnQocGFyKTsNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIGFwaS5jbG9zZVdpbih7fSk7DQogICAgICAgIH0sIDIwMCk7DQogICAgfSwNCiAgICAvLyDngrnlh7vov5Tlm54g5Zyo5Yir55qEd2luZG9344CBZnJhbWUg5omn6KGM5LiA5Liq5LqL5Lu2DQogICAgYmFja1dpbkV4ZWNEYXRhOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgdGhpcy5leGVjU2NyaXB0KHBhcik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBhcGkuY2xvc2VXaW4oe30pOw0KICAgICAgICB9LCAyMDApOw0KICAgIH0sDQogICAgYW5kcmlvZEJhY2tNYWluOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgYXBpLmFkZEV2ZW50TGlzdGVuZXIoew0KICAgICAgICAgICAgbmFtZTogJ2tleWJhY2snDQogICAgICAgIH0sIGZ1bmN0aW9uKHJldCwgZXJyKSB7DQogICAgICAgICAgICBwYXIuY2IgJiYgdHlwZW9mIHBhci5jYiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuY2IoKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICAvLyDlronljZPmiYvmnLroh6rluKbov5Tlm57vvIxrZXliYWNrDQogICAgYW5kcmlvZEJhY2s6IGZ1bmN0aW9uKCkgew0KICAgICAgICBhcGkuYWRkRXZlbnRMaXN0ZW5lcih7DQogICAgICAgICAgICBuYW1lOiAna2V5YmFjaycNCiAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpIHsNCiAgICAgICAgICAgIGFwaS5jbG9zZVdpbih7fSk7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5a6J5Y2T5omL5py66Ieq5bim6L+U5Zue77yMa2V5YmFjayBleGVjU2NyaXB0DQogICAgYW5kcmlvZEJhY2tFeGVjRGF0YTogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIGFwaS5hZGRFdmVudExpc3RlbmVyKHsNCiAgICAgICAgICAgIG5hbWU6ICdrZXliYWNrJw0KICAgICAgICB9LCBmdW5jdGlvbihyZXQsIGVycikgew0KICAgICAgICAgICAgX3RoaXMuZXhlY1NjcmlwdChwYXIpOw0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBhcGkuY2xvc2VXaW4oe30pOw0KICAgICAgICAgICAgfSwgMjAwKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICAvLyDlronljZPmiYvmnLroh6rluKbov5Tlm57vvIxrZXliYWNrIHNlbmRFdmVudA0KICAgIGFuZHJpb2RCYWNrU2VuZERhdGE6IGZ1bmN0aW9uKHBhcikgew0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICBhcGkuYWRkRXZlbnRMaXN0ZW5lcih7DQogICAgICAgICAgICBuYW1lOiAna2V5YmFjaycNCiAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpIHsNCiAgICAgICAgICAgIF90aGlzLnNlbmRFdmVudChwYXIpOw0KICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICBhcGkuY2xvc2VXaW4oe30pOw0KICAgICAgICAgICAgfSwgMjAwKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBiYWNrVG86IGZ1bmN0aW9uKG5hbWUpIHsNCiAgICAgICAgYXBpLmNsb3NlVG9XaW4oew0KICAgICAgICAgICAgbmFtZTogbmFtZQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGJhY2tUb0V4ZWNEYXRhOiBmdW5jdGlvbihuYW1lLCBwYXIpIHsNCiAgICAgICAgdGhpcy5leGVjU2NyaXB0KHBhcik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBhcGkuY2xvc2VUb1dpbih7DQogICAgICAgICAgICAgICAgbmFtZTogbmFtZQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sIDIwMCk7DQogICAgfSwNCiAgICBiYWNrVG9TZW5kRGF0YTogZnVuY3Rpb24obmFtZSwgcGFyKSB7DQogICAgICAgIHRoaXMuc2VuZEV2ZW50KHBhcik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBhcGkuY2xvc2VUb1dpbih7DQogICAgICAgICAgICAgICAgbmFtZTogbmFtZQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0sIDIwMCk7DQogICAgfSwNCiAgICBiYWNrRnJhbWU6IGZ1bmN0aW9uKCkgew0KICAgICAgICBhcGkuY2xvc2VGcmFtZSh7fSk7DQogICAgfSwNCiAgICBiYWNrRnJhbWVTZW5kRGF0YTogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHRoaXMuc2VuZEV2ZW50KHBhcik7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgICAgICBhcGkuY2xvc2VGcmFtZSh7fSk7DQogICAgICAgIH0sIDIwMCk7DQogICAgfSwNCiAgICBiYWNrRnJhbWVFeGVjRGF0YTogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHRoaXMuZXhlY1NjcmlwdChwYXIpOw0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgYXBpLmNsb3NlRnJhbWUoe30pOw0KICAgICAgICB9LCAyMDApOw0KICAgIH0sDQogICAgLy8g5Y+R6YCB5o6o6YCBIGFwaS5zZW5kRXZlbnQNCiAgICBzZW5kRXZlbnQ6IGZ1bmN0aW9uKHBhcikgew0KICAgICAgICBwYXIgPSBwYXIgfHwge307DQogICAgICAgIHBhci5kYXRhID0gdHlwZW9mIHBhci5kYXRhID09PSAndW5kZWZpbmVkJyB8fCBCb29sZWFuKHBhci5kYXRhKSA9PT0gZmFsc2UgPyB7fSA6IHBhci5kYXRhOw0KICAgICAgICBpZiAocGFyLmRhdGEpIHsNCiAgICAgICAgICAgIGFwaS5zZW5kRXZlbnQoew0KICAgICAgICAgICAgICAgIG5hbWU6IHBhci5uYW1lLA0KICAgICAgICAgICAgICAgIGV4dHJhOiBwYXIuZGF0YQ0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnYXBpLnNlbmRFdmVudCAg5pyq5Lyg5YWl5o6o6YCB55qE5Y+C5pWwJyk7DQogICAgICAgIH0NCiAgICB9LA0KICAgIC8vIOWcqOafkOS4gOS4qndpbmRvd+OAgWZyYW1lIOaJp+ihjOS4gOS4qiDmlrnms5UNCiAgICBleGVjU2NyaXB0OiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBwYXIubmFtZSA9IHBhci5uYW1lIHx8ICcnOw0KICAgICAgICBwYXIuZnJhbWVOYW1lID0gcGFyLmZyYW1lTmFtZSB8fCAnJzsNCiAgICAgICAgLy8gcGFyLmZ1bmMg5piv5LiA5Liq5Ye95pWw5ZCNDQogICAgICAgIHBhci5mdW5jID0gcGFyLmZ1bmMgfHwgJyc7DQogICAgICAgIGlmIChwYXIuZnVuYykgew0KICAgICAgICAgICAgYXBpLmV4ZWNTY3JpcHQoew0KICAgICAgICAgICAgICAgIG5hbWU6IHBhci5uYW1lLA0KICAgICAgICAgICAgICAgIGZyYW1lTmFtZTogcGFyLmZyYW1lTmFtZSwNCiAgICAgICAgICAgICAgICBzY3JpcHQ6IHBhci5mdW5jDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhcGkuZXhlY1NjcmlwdCDmnKrkvKDlhaXlh73mlbDlkI0nKQ0KICAgICAgICB9DQogICAgfSwNCiAgICAvLyDmiZPlvIDkuIDkuKrmlrDnmoR3aW7pobXpnaINCiAgICAvLyBuYW1lICAgIOW/heWhq+mhuSDnqpflj6PlkI3lrZcgIFN0cmluZw0KICAgIC8vIHBhdGggICAg5b+F5aGr6aG5IOeql+WPo+i3r+W+hCAgU3RyaW5nDQogICAgLy8gcGFyYW0gICDpnZ7lv4XloavpobkgIOS8oOWFpeeahOi3r+W+hCAgT2JqZWN0DQogICAgLy8gYm91bmNlcyDpnZ7lv4XloavpobkgIOeql+WPo+aYr+WQpuWPr+S7peW8ueWKqCBCb29sZWFuDQogICAgLy8gYWxsb3dFZGl0ICDpnZ7lv4XloavpobkgIOeql+WPo+aYr+WQpuWPr+S7pee8lui+ke+8jOWkjeWItu+8jOeymOi0tOWKn+iDvSAgQm9vbGVhbg0KICAgIC8vIHJlbG9hZCAg6Z2e5b+F5aGr6aG5ICAg56qX5Y+j5piv5ZCm6YeN5paw5Yqg6L29IEJvb2xlYW4NCiAgICBvcGVuV2luOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBwYXIucGFyYW0gPSBwYXIucGFyYW0gPT09IHVuZGVmaW5lZCB8fCBwYXIucGFyYW0gPT0gZmFsc2UgPyB7fSA6IHBhci5wYXJhbTsNCiAgICAgICAgcGFyLmJvdW5jZXMgPSBwYXIuYm91bmNlcyA9PT0gdW5kZWZpbmVkIHx8IHBhci5ib3VuY2VzID09IGZhbHNlID8gZmFsc2UgOiBwYXIuYm91bmNlczsNCiAgICAgICAgcGFyLmFsbG93RWRpdCA9IHBhci5hbGxvd0VkaXQgPT09IHVuZGVmaW5lZCB8fCBwYXIuYWxsb3dFZGl0ID09IGZhbHNlID8gZmFsc2UgOiBwYXIuYWxsb3dFZGl0Ow0KICAgICAgICBwYXIucmVsb2FkID0gcGFyLnJlbG9hZCA9PT0gdW5kZWZpbmVkIHx8IHBhci5yZWxvYWQgPT0gZmFsc2UgPyBmYWxzZSA6IHBhci5yZWxvYWQ7DQogICAgICAgIHBhci5iZ0NvbG9yID0gcGFyLmJnQ29sb3IgPT09IHVuZGVmaW5lZCB8fCBwYXIuYmdDb2xvciA9PSBmYWxzZSA/ICcjZmZmJyA6IHBhci5iZ0NvbG9yOw0KICAgICAgICBhcGkub3Blbldpbih7DQogICAgICAgICAgICBuYW1lOiBwYXIubmFtZSwNCiAgICAgICAgICAgIHVybDogcGFyLnBhdGgsDQogICAgICAgICAgICBwYWdlUGFyYW06IHBhci5wYXJhbSwNCiAgICAgICAgICAgIGJvdW5jZXM6IHBhci5ib3VuY2VzLA0KICAgICAgICAgICAgYmdDb2xvcjpwYXIuYmdDb2xvciwNCiAgICAgICAgICAgIHByb2dyZXNzOiB7DQogICAgICAgICAgICAgICAgdHlwZTogJ3BhZ2UnLA0KICAgICAgICAgICAgICAgIHRpdGxlOiAn5q2j5Zyo5Yqg6L295LitLi4uJywNCiAgICAgICAgICAgICAgICB0ZXh0OiAn6K+3562J5b6FLi4uJywNCiAgICAgICAgICAgICAgICBjb2xvcjogJycNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB2U2Nyb2xsQmFyRW5hYmxlZDogZmFsc2UsDQogICAgICAgICAgICBoU2Nyb2xsQmFyRW5hYmxlZDogZmFsc2UsDQogICAgICAgICAgICBhbGxvd0VkaXQ6IHBhci5hbGxvd0VkaXQsDQogICAgICAgICAgICByZWxvYWQ6IHBhci5yZWxvYWQsDQogICAgICAgICAgICBzbGlkQmFja0VuYWJsZWQ6IGZhbHNlDQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5omT5byA5LiA5LiqZnJhbWUgcGFyLm5hbWUgcGFyLmJvdW5jZXMg5b+F6aG75aGrDQogICAgb3BlbkZyYW1lOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBwYXIucGFyYW0gPSBwYXIucGFyYW0gPT09IHVuZGVmaW5lZCB8fCBwYXIucGFyYW0gPT0gZmFsc2UgPyB7fSA6IHBhci5wYXJhbTsNCiAgICAgICAgcGFyLmJvdW5jZXMgPSBwYXIuYm91bmNlcyA9PT0gdW5kZWZpbmVkIHx8IHBhci5ib3VuY2VzID09IGZhbHNlID8gZmFsc2UgOiBwYXIuYm91bmNlczsNCiAgICAgICAgcGFyLmFsbG93RWRpdCA9IHBhci5hbGxvd0VkaXQgPT09IHVuZGVmaW5lZCB8fCBwYXIuYWxsb3dFZGl0ID09IGZhbHNlID8gdHJ1ZSA6IHBhci5hbGxvd0VkaXQ7DQogICAgICAgIHBhci5yZWxvYWQgPSBwYXIucmVsb2FkID09PSB1bmRlZmluZWQgfHwgcGFyLnJlbG9hZCA9PSBmYWxzZSA/IGZhbHNlIDogcGFyLnJlbG9hZDsNCiAgICAgICAgcGFyLnggPSB0eXBlb2YgcGFyLnggPT09ICd1bmRlZmluZWQnIHx8IHBhci54ID09IGZhbHNlID8gMCA6IHBhci54Ow0KICAgICAgICBwYXIueSA9IHR5cGVvZiBwYXIueSA9PT0gJ3VuZGVmaW5lZCcgfHwgcGFyLnkgPT0gZmFsc2UgPyAwIDogcGFyLnk7DQogICAgICAgIHBhci53ID0gdHlwZW9mIHBhci53ID09PSAndW5kZWZpbmVkJyB8fCBwYXIudyA9PSBmYWxzZSA/ICdhdXRvJyA6IHBhci53Ow0KICAgICAgICBwYXIuaCA9IHR5cGVvZiBwYXIuaCA9PT0gJ3VuZGVmaW5lZCcgfHwgcGFyLmggPT0gZmFsc2UgPyAnYXV0bycgOiBwYXIuaDsNCiAgICAgICAgcGFyLmJnQ29sb3IgPSB0eXBlb2YgcGFyLmJnQ29sb3IgPT09ICd1bmRlZmluZWQnIHx8IHBhci5iZ0NvbG9yID09IGZhbHNlID8gJ3JnYmEoMCwwLDAsLjUpJyA6IHBhci5iZ0NvbG9yOw0KICAgICAgICBwYXIuYW5pbWF0aW9uID0gdHlwZW9mIHBhci5hbmltYXRpb24gPT09ICd1bmRlZmluZWQnIHx8IHBhci5hbmltYXRpb24gPT0gZmFsc2UgPyB7fSA6IHBhci5hbmltYXRpb247DQogICAgICAgIHBhci5hbmltYXRpb25bJ3R5cGUnXSA9IHBhci5hbmltYXRpb25bJ3R5cGUnXSB8fCAnbW92ZWluJzsNCiAgICAgICAgcGFyLmFuaW1hdGlvblsnc3ViVHlwZSddID0gcGFyLmFuaW1hdGlvblsnc3ViVHlwZSddIHx8ICdmcm9tX3JpZ2h0JzsNCiAgICAgICAgcGFyLmFuaW1hdGlvblsnZHVyYXRpb24nXSA9IHBhci5hbmltYXRpb25bJ2R1cmF0aW9uJ10gfHwgMzAwOw0KICAgICAgICAvKioNCgkJICoJcGFyLmFuaW1hdGlvbiA9IHsNCgkJICoJCXR5cGU6J25vbmUnICAg6buY6K6kIG5vbmUgIC8v5peg5Yqo55S75pWI5p6cDQoJCSAJCQkJCSAgcHVzaCAgICAgICAvL+aWsOinhuWbvuWwhuaXp+inhuWbvuaOqOW8gA0KCQkJCQkJCSAgbW92ZWluICAgICAvL+aWsOinhuWbvuenu+WIsOaXp+inhuWbvuS4iumdog0KCQkJCQkJCSAgZmFkZSAgICAgICAvL+S6pOWPiea3oeWMlui/h+a4oe+8iOS4jeaUr+aMgei/h+a4oeaWueWQke+8iQ0KCQkJCQkJCSAgZmxpcCAgICAgICAvL+e/u+i9rOaViOaenA0KCQkJCQkJCSAgcmV2ZWFsICAgICAvL+WwhuaXp+inhuWbvuenu+W8gCzmmL7npLrkuIvpnaLnmoTmlrDop4blm74NCgkJCQkJCQkgIHJpcHBsZSAgICAgLy/mu7TmsLTmlYjmnpzvvIjkuI3mlK/mjIHov4fmuKHmlrnlkJHvvIkNCgkJCQkJCQkgIGN1cmwgICAgICAgLy/lkJHkuIrnv7vkuIDpobUNCgkJCQkJCQkgIHVuX2N1cmwgICAgLy/lkJHkuIvnv7vkuIDpobUNCgkJCQkJCQkgIHN1Y2sgICAgICAgLy/mlLbnvKnmlYjmnpzvvIjkuI3mlK/mjIHov4fmuKHmlrnlkJHvvIkNCgkJCQkJCQkgIGN1YmUgICAgICAgLy/nq4vmlrnkvZPnv7vmu5rmlYjmnpwNCg0KCQkJCXN1YlR5cGUgICAgICAgZnJvbV9yaWdodCAgICAgICAgLy/ku47lj7PovrnlvIDlp4vliqjnlLsNCgkJCQkJCQkgIGZyb21fbGVmdCAgICAgICAgLy/ku47lt6bovrnlvIDlp4vliqjnlLsNCgkJCQkJCQkgIGZyb21fdG9wICAgICAgICAvL+S7jumhtumDqOW8gOWni+WKqOeUuw0KCQkJCQkJCSAgZnJvbV9ib3R0b20gICAgICAgIC8v5LuO5bqV6YOo5byA5aeL5Yqo55S7DQoJCQkgICAgZHVyYXRpb24gICAgICAzMDANCgkgCSAqIH0NCgkJICovDQogICAgICAgIGFwaS5vcGVuRnJhbWUoew0KICAgICAgICAgICAgbmFtZTogcGFyLm5hbWUsDQogICAgICAgICAgICB1cmw6IHBhci5wYXRoLA0KICAgICAgICAgICAgcmVjdDogew0KICAgICAgICAgICAgICAgIHg6IHBhci54LA0KICAgICAgICAgICAgICAgIHk6IHBhci55LA0KICAgICAgICAgICAgICAgIHc6IHBhci53LA0KICAgICAgICAgICAgICAgIGg6IHBhci5oDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcGFnZVBhcmFtOiBwYXIucGFyYW0sDQogICAgICAgICAgICBib3VuY2VzOiBwYXIuYm91bmNlcywNCiAgICAgICAgICAgIGJnQ29sb3I6IHBhci5iZ0NvbG9yLA0KICAgICAgICAgICAgdlNjcm9sbEJhckVuYWJsZWQ6IGZhbHNlLA0KICAgICAgICAgICAgaFNjcm9sbEJhckVuYWJsZWQ6IGZhbHNlLA0KICAgICAgICAgICAgYWxsb3dFZGl0OiBwYXIuYWxsb3dFZGl0LA0KICAgICAgICAgICAgcmVsb2FkOiBwYXIucmVsb2FkLA0KICAgICAgICAgICAgYW5pbWF0aW9uOiBwYXIuYW5pbWF0aW9uDQogICAgICAgIH0pOw0KDQogICAgfQ0KfTsNCi8vIOWPquaYr+WFs+mXreW9k+WJjemhtemdog0KZnVuY3Rpb24gd0JhY2tUaGlzRnVuYygpIHsNCiAgICB3SHJlZkpzLmJhY2tXaW4oKTsNCn0NCi8vIOebkeWQrOe9kee7nOeKtuaAgQ0KdmFyIGxpc3Rlbk9ubGluZSA9IHsNCiAgICBvbmxpbmU6ZnVuY3Rpb24oY2Ipew0KICAgICAgICBhcGkuYWRkRXZlbnRMaXN0ZW5lcih7DQogICAgICAgICAgICBuYW1lOiAnb25saW5lJw0KICAgICAgICB9LCBmdW5jdGlvbihyZXQsIGVycil7DQogICAgICAgICAgICBpZiggcmV0ICl7DQogICAgICAgICAgICAgICAgIGNiICYmIHR5cGVvZiBjYiA9PT0gJ2Z1bmN0aW9uJyAmJiBjYi5jYWxsKHRoaXMpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIG9mZmxpbmU6ZnVuY3Rpb24oY2Ipew0KICAgICAgICBhcGkuYWRkRXZlbnRMaXN0ZW5lcih7DQogICAgICAgICAgICBuYW1lOiAnb2ZmbGluZScNCiAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpew0KICAgICAgICAgICAgaWYoIHJldCApew0KICAgICAgICAgICAgICAgICBjYiAmJiB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicgJiYgY2IuY2FsbCh0aGlzKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBsaW5lU3RhdHVzOmZ1bmN0aW9uKCl7DQogICAgICAgIHJldHVybiBhcGkuY29ubmVjdGlvblR5cGU7DQogICAgfQ0KfTsNCi8vIOmUmeivr+eKtuaAgeeggSAgIDAg6KGo56S65Li656m6ICAgMTAxIOihqOekuumqjOivgeWksei0pSAgIDHooajnpLrpqozor4HmiJDlip8gIDEwMuihqOekuumVv+W6pui/h+efrSAgIDEwM+ihqOekuumVv+W6pui/h+mVvyAgMTA06KGo56S65a+55q+U6aqM6K+B5Lik5Liq5YC85LiN55u4562JDQp2YXIgd1ZhbGlkYXRlID0gew0KICAgIGZsYWc6IHt9LA0KICAgIGNoZWNrUGhvbmU6IGZ1bmN0aW9uKHBob25lKSB7DQogICAgICAgIHZhciBwaG9uZUV4cCA9IC9eMVszNDU2Nzg5XVxkezl9JC87DQogICAgICAgIGlmIChwaG9uZSA9PSAwIHx8IHBob25lID09IG51bGwgfHwgcGhvbmUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB0aGlzLmZsYWcuY29kZSA9IDA7DQogICAgICAgICAgICB0aGlzLmZsYWcuc3RhdHVzID0gZmFsc2U7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9IGVsc2UgaWYgKCFwaG9uZUV4cC50ZXN0KHBob25lKSkgew0KICAgICAgICAgICAgdGhpcy5mbGFnLmNvZGUgPSAxMDE7DQogICAgICAgICAgICB0aGlzLmZsYWcuc3RhdHVzID0gZmFsc2U7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5mbGFnLmNvZGUgPSAxOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9DQogICAgfSwNCiAgICBjaGVja05hbWU6IGZ1bmN0aW9uKG5hbWUpIHsNCiAgICAgICAgLy8gdmFyIG5hbWVFeHAgPSAvW1x1NGUwMC1cdTlmYTVfYS16QS1aMC05X117MSwxNn0vOw0KICAgICAgICBpZiAobmFtZSA9PSAwIHx8IG5hbWUgPT0gbnVsbCB8fCBuYW1lID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgdGhpcy5mbGFnLmNvZGUgPSAwOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfSBlbHNlIGlmIChuYW1lLmxlbmd0aCA8IDIpIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTAyOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfSBlbHNlIGlmIChuYW1lLmxlbmd0aCA+IDE2KSB7DQogICAgICAgICAgICB0aGlzLmZsYWcuY29kZSA9IDEwMzsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSBmYWxzZTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZsYWc7DQogICAgICAgIH0NCiAgICAgICAgLy8gZWxzZSBpZighbmFtZUV4cC50ZXN0KG5hbWUpKXsNCiAgICAgICAgLy8gICAgIHRoaXMuZmxhZy5jb2RlID0gMTAxOw0KICAgICAgICAvLyAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgLy8gfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSB0cnVlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgY2hlY2tQd2Q6IGZ1bmN0aW9uKHB3ZCkgew0KICAgICAgICB2YXIgcHdkRXhwID0gL15bYS16QS1aMC05XSskLzsNCiAgICAgICAgaWYgKHB3ZCA9PSAwIHx8IHB3ZCA9PSBudWxsIHx8IHB3ZCA9PSB1bmRlZmluZWQgfHwgcHdkID09ICcnKSB7DQogICAgICAgICAgICB0aGlzLmZsYWcuY29kZSA9IDA7DQogICAgICAgICAgICB0aGlzLmZsYWcuc3RhdHVzID0gZmFsc2U7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9IGVsc2UgaWYgKCFwd2RFeHAudGVzdChwd2QpKSB7DQogICAgICAgICAgICB0aGlzLmZsYWcuY29kZSA9IDEwMTsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSBmYWxzZTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZsYWc7DQogICAgICAgIH0gZWxzZSBpZiAocHdkLmxlbmd0aCA8IDYpIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTAyOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfSBlbHNlIGlmIChwd2QubGVuZ3RoID4gMTYpIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTAzOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSB0cnVlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgY2hlY2tDb250cmFzdFB3ZDogZnVuY3Rpb24ocHdkMCwgcHdkMSkgew0KICAgICAgICBpZiAocHdkMCA9PT0gcHdkMSkgew0KICAgICAgICAgICAgdGhpcy5mbGFnLmNvZGUgPSAxOw0KICAgICAgICAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5mbGFnLmNvZGUgPSAxMDQ7DQogICAgICAgICAgICB0aGlzLmZsYWcuc3RhdHVzID0gZmFsc2U7DQogICAgICAgICAgICByZXR1cm4gdGhpcy5mbGFnOw0KICAgICAgICB9DQogICAgfSwNCiAgICBjaGVja0lkQ2FyZDogZnVuY3Rpb24oY2FyZCkgew0KICAgICAgICAvLyB2YXIgZXhwQ2FyZCA9IC9eKF5bMS05XVxkezd9KCgwXGQpfCgxWzAtMl0pKSgoWzB8MXwyXVxkKXwzWzAtMV0pXGR7M30kKXwoXlsxLTldXGR7NX1bMS05XVxkezN9KCgwXGQpfCgxWzAtMl0pKSgoWzB8MXwyXVxkKXwzWzAtMV0pKChcZHs0fSl8XGR7M31bWHhdKSQpJC87DQogICAgICAgIGlmIChjYXJkID09ICcnIHx8IGNhcmQgPT0gbnVsbCB8fCBjYXJkID09IDAgfHwgY2FyZCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMDsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSBmYWxzZTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZsYWc7DQogICAgICAgIH0NCiAgICAgICAgLy8gZWxzZSBpZighZXhwQ2FyZC50ZXN0KGV4cENhcmQpKXsNCiAgICAgICAgLy8gICAgIHRoaXMuZmxhZy5jb2RlID0gMTAxOw0KICAgICAgICAvLyAgICAgdGhpcy5mbGFnLnN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAvLyAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgLy8gfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMTsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSB0cnVlOw0KICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmxhZzsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgY2hlY2tBZ2U6IGZ1bmN0aW9uKGFnZSkgew0KICAgICAgICBpZiAoYWdlID09ICcnIHx8IGFnZSA9PSBudWxsIHx8IGFnZSA9PSAwIHx8IGFnZSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5jb2RlID0gMDsNCiAgICAgICAgICAgIHRoaXMuZmxhZy5zdGF0dXMgPSBmYWxzZTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZsYWc7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aGlzLmZsYWcuY29kZSA9IDE7DQogICAgICAgICAgICB0aGlzLmZsYWcuc3RhdHVzID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiB0aGlzLmZsYWc7DQogICAgICAgIH0NCiAgICB9DQp9Ow0KDQovKioNCiAqIEBBdXRob3IgICB3cA0KICogQERhdGVUaW1lIDIwMTgtMDgtMDcNCiAqIEB2ZXJzaW9uICAxLjAuMA0KICogQGRlc2MgICAgIOWwgeijhSBsb2NhbFN0b3JhZ2Ug5pa55rOVDQogKi8NCnZhciBteUxvY2FsU3RvcmFnZSA9IHsNCiAgICBsb2NhbDogd2luZG93LmxvY2FsU3RvcmFnZSwNCiAgICBpbml0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgaWYgKHRoaXMubG9jYWwpIHsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ+S4jeaUr+aMgWxvY2FsU3RvcmFnZeaWueazlScpDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7Ow0KICAgICAgICB9DQogICAgfSwNCiAgICBzZXRJdGVtOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7DQogICAgICAgIGlmICh0aGlzLmluaXQoKSkgew0KICAgICAgICAgICAgdGhpcy5sb2NhbC5zZXRJdGVtKGtleSwgdmFsdWUpOw0KICAgICAgICB9DQogICAgfSwNCiAgICBnZXRJdGVtOiBmdW5jdGlvbihrZXkpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWwuZ2V0SXRlbShrZXkpOw0KICAgIH0sDQogICAgY2xlYXJJdGVtOiBmdW5jdGlvbihrZXkpIHsNCiAgICAgICAgdGhpcy5sb2NhbC5yZW1vdmVJdGVtKGtleSk7DQogICAgfSwNCiAgICBjbGVhckFsbDogZnVuY3Rpb24oKSB7DQogICAgICAgIHRoaXMubG9jYWwuY2xlYXIoKTsNCiAgICB9DQp9Ow0KDQovKioNCiAqIEBBdXRob3IgICB3cA0KICogQERhdGVUaW1lIDIwMTgtMDgtMDgNCiAqIEB2ZXJzaW9uICAxLjAuMA0KICogQGRlc2MgICAgIHRleHRhcmVhIOiHqumAguW6lA0KICovDQpmdW5jdGlvbiB0ZXh0YXJlYUhlaWdodEFkYXB0aW9uRm4obykgew0KICAgIG8uc3R5bGUuaGVpZ2h0ID0gby5zY3JvbGxUb3AgKyBvLnNjcm9sbEhlaWdodCArICJweCI7DQp9Ow0KLyoqDQogKiAg5bCB6KOFIGFwaWNsb3VkIOiHquW4pueahCDlvLnmoYbnu4Tku7YNCiAqICBtc2cg5b+F5aGrDQogKi8NCnZhciB3RGlhbG9nID0gew0KICAgIHRvYXN0OiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBwYXIuZHVyYXRpb24gPSBwYXIuZHVyYXRpb24gPyBpc05hTihOdW1iZXIocGFyLmR1cmF0aW9uKSkgPT0gdHJ1ZSA/IDgwMCA6IHBhci5kdXJhdGlvbiA6IDgwMDsNCiAgICAgICAgcGFyLmxvY2F0aW9uID0gcGFyLmxvY2F0aW9uIHx8ICdib3R0b20nOw0KICAgICAgICAvLyBnbG9iYWwg6K6+572u5Li6IHRydWUg5a6J5Y2T5omL5py65LiK6Z2i5by55Ye655qE5L2N572u5bCG5Lya5Zu65a6a5Zyo5bqV6YOo5Yy65Z+fDQogICAgICAgIHBhci5nbG9iYWwgPSBwYXIuZ2xvYmFsIHx8IHRydWU7DQogICAgICAgIGFwaS50b2FzdCh7DQogICAgICAgICAgICBtc2c6IHBhci5tc2csDQogICAgICAgICAgICBkdXJhdGlvbjogcGFyLmR1cmF0aW9uLA0KICAgICAgICAgICAgbG9jYXRpb246IHBhci5sb2NhdGlvbiwNCiAgICAgICAgICAgIGdsb2JhbDogcGFyLmdsb2JhbA0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGFsZXJ0OiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBhcGkuYWxlcnQoew0KICAgICAgICAgICAgdGl0bGU6IHBhci50aXRsZSB8fCAnJywNCiAgICAgICAgICAgIG1zZzogcGFyLm1zZywNCiAgICAgICAgICAgIGJ1dHRvbnM6IHBhci5idXR0b24gfHwgWyfnoa7lrponXQ0KICAgICAgICB9LCBmdW5jdGlvbihyZXQsIGVycikgew0KICAgICAgICAgICAgaWYgKHJldC5idXR0b25JbmRleCA9PSAxKSB7DQogICAgICAgICAgICAgICAgcGFyLmNiICYmIHR5cGVvZiBwYXIuY2IgPT09ICdmdW5jdGlvbicgJiYgcGFyLmNiKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgY29uZmlybTogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHBhciA9IHBhciB8fCB7fTsNCiAgICAgICAgYXBpLmNvbmZpcm0oew0KICAgICAgICAgICAgdGl0bGU6ICcnLA0KICAgICAgICAgICAgbXNnOiBwYXIubXNnLA0KICAgICAgICAgICAgYnV0dG9uczogcGFyLmJ1dHRvbiB8fCBbJ+ehruWumicsICflj5bmtognXQ0KICAgICAgICB9LCBmdW5jdGlvbihyZXQsIGVycikgew0KICAgICAgICAgICAgaWYgKHJldC5idXR0b25JbmRleCA9PSAxKSB7DQogICAgICAgICAgICAgICAgcGFyLnN1cmVDYiAmJiB0eXBlb2YgcGFyLnN1cmVDYiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuc3VyZUNiKCk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIHBhci5jYW5jZWxDYiAmJiB0eXBlb2YgcGFyLmNhbmNlbENiID09PSAnZnVuY3Rpb24nICYmIHBhci5jYW5jZWxDYigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIC8vIOW8ueWHuuW4puS4pOS4quaIluS4ieS4quaMiemSruWSjOi+k+WFpeahhueahOWvueivneahhg0KICAgIHByb21wdDogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHBhciA9IHBhciB8fCB7fTsNCiAgICAgICAgYXBpLnByb21wdCh7DQogICAgICAgICAgICB0aXRsZTogcGFyLnRpdGxlIHx8ICcnLA0KICAgICAgICAgICAgbXNnOiBwYXIubXNnLA0KICAgICAgICAgICAgdGV4dDogcGFyLnRleHQgfHwgJycsDQogICAgICAgICAgICB0eXBlOiBwYXIudHlwZSB8fCAndGV4dCcsDQogICAgICAgICAgICBidXR0b25zOiBwYXIuYnV0dG9uIHx8IFsn56Gu5a6aJywgJ+WPlua2iCddIC8v6Iul5bCP5LqO5Lik5Liq5oyJ6ZKu77yM5Lya6KGl6b2Q5Lik5Liq5oyJ6ZKu77yb6Iul5aSn5LqO5LiJ5Liq5oyJ6ZKu77yM5YiZ5L2/55So5YmN5LiJ5Liq5oyJ6ZKuDQogICAgICAgIH0sIGZ1bmN0aW9uKHJldCwgZXJyKSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShyZXQpKQ0KICAgICAgICAgICAgcGFyLmNiICYmIHR5cGVvZiBwYXIuY2IgPT09ICdmdW5jdGlvbicgJiYgcGFyLmNiKHJldCk7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5bqV6YOo5by55Ye65qGGDQogICAgYWN0aW9uU2hlZXQ6IGZ1bmN0aW9uKHBhcikgew0KICAgICAgICBwYXIgPSBwYXIgfHwge307DQogICAgICAgIGFwaS5hY3Rpb25TaGVldCh7DQogICAgICAgICAgICB0aXRsZTogcGFyLnRpdGxlIHx8ICcnLA0KICAgICAgICAgICAgY2FuY2VsVGl0bGU6IHBhci5jYW5jZWwgfHwgJ+WPlua2iCcsDQogICAgICAgICAgICBkZXN0cnVjdGl2ZVRpdGxlOiBwYXIuZGVzdCB8fCAnJywNCiAgICAgICAgICAgIGJ1dHRvbnM6IHBhci5idXR0b24gfHwgWyfmi43nhacnLCAn5LuO55u45YaM5Lit6YCJ5oupJ10sDQogICAgICAgICAgICBzdHlsZTogew0KICAgICAgICAgICAgICAgIGxheWVyQ29sb3I6ICcnLCAvL+mBruiUveWxguminOiJsu+8jOS7heaUr+aMgSByZ2Jh6aKc6Imy77yM6buY6K6k5YC877yacmdiYe+8iDAsIDAsIDAsIDAuNO+8iQ0KICAgICAgICAgICAgICAgIGl0ZW1Ob3JtYWxDb2xvcjogJyNGMUYxRjEnLCAvL+mAiemhueaMiemSruato+W4uOeKtuaAgeiDjOaZr+minOiJsiDpu5jorqTlgLzvvJojRjFGMUYxDQogICAgICAgICAgICAgICAgaXRlbVByZXNzQ29sb3I6ICcjRjFGMUYxJywgLy/pgInpobnmjInpkq7mjInkuIvml7bog4zmma/popzoibLvvIzpu5jorqTlgLzvvJojRTZFNkU2DQogICAgICAgICAgICAgICAgZm9udE5vcm1hbENvbG9yOiAnIzAwN0FGRicsIC8v6YCJ6aG55oyJ6ZKu5q2j5bi454q25oCB5paH5a2X6aKc6Imy77yM6buY6K6k5YC877yaIzAwN0FGRg0KICAgICAgICAgICAgICAgIGZvbnRQcmVzc0NvbG9yOiAnIzAwN0FGRicsIC8v6YCJ6aG55oyJ6ZKu5oyJ5LiL5pe25paH5a2X6aKc6Imy77yM5pSv5oyBIzAwMOOAgSMwMDAwMDDjgIFyZ2LjgIFyZ2Jh77yM6buY6K6k5YC877yaIzAwNjBGMA0KICAgICAgICAgICAgICAgIHRpdGxlRm9udENvbG9yOiAnJyAvL+agh+mimOaWh+Wtl+minOiJsu+8jOm7mOiupOWAvO+8miM4RjhGOEYNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpIHsNCiAgICAgICAgICAgIGlmIChyZXQuYnV0dG9uSW5kZXgpIHsNCiAgICAgICAgICAgICAgICBwYXIuY2IgJiYgdHlwZW9mIHBhci5jYiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuY2IocmV0KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FjdGlvblNoZWV0IOW8ueWHuuahhumUmeivrycpDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g5pi+56S66L+b5bqm5o+Q56S65qGGDQogICAgc2hvd1Byb2dyZXNzOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBhcGkuc2hvd1Byb2dyZXNzKHsNCiAgICAgICAgICAgIHN0eWxlOiAnZGVmYXVsdCcsDQogICAgICAgICAgICBhbmltYXRpb25UeXBlOiBwYXIuYW5pbWF0ZVR5cGUgfHwgJ2ZhZGUnLA0KICAgICAgICAgICAgdGl0bGU6IHBhci50aXRsZSB8fCAn5Yqq5Yqb5Yqg6L295LitLi4uJywNCiAgICAgICAgICAgIHRleHQ6IHBhci50ZXh0IHx8ICfor7fnqI3nrYkuLi4nLA0KICAgICAgICAgICAgbW9kYWw6IHBhci5tb2RhbCB8fCB0cnVlDQogICAgICAgIH0pOw0KICAgIH0sDQogICAgLy8g6ZqQ6JeP6L+b5bqm5o+Q56S65qGGDQogICAgaGlkZVByb2dyZXNzOiBmdW5jdGlvbigpIHsNCiAgICAgICAgYXBpLmhpZGVQcm9ncmVzcygpOw0KICAgIH0NCn07DQoNCi8qKg0KICogIOWGjeasoeWwgeijhSBhcGkuc2V0UHJlZnMgLyBhcGkuZ2V0UHJlZnMgLyBhcGkucmVtb3ZlUHJlZnMNCiAqLw0KdmFyIHdQcmVmID0gew0KICAgIC8vIOiuvue9ruWBj+WlvQ0KICAgIHNldFByZWZzOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBhcGkuc2V0UHJlZnMoew0KICAgICAgICAgICAga2V5OiBwYXIua2V5LA0KICAgICAgICAgICAgdmFsdWU6IHBhci52YWx1ZQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIC8vIOiOt+WPluWBj+WlveaVsOaNrg0KICAgIGdldFByZWZzOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgcGFyID0gcGFyIHx8IHt9Ow0KICAgICAgICBpZiAocGFyLnN5bmMgPT09IGZhbHNlKSB7DQogICAgICAgICAgICBhcGkuZ2V0UHJlZnMoew0KICAgICAgICAgICAgICAgIGtleTogcGFyLmtleQ0KICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpIHsNCiAgICAgICAgICAgICAgICBwYXIuY2IgJiYgdHlwZW9mIHBhci5jYiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuY2IocmV0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgY29uc29sZS5sb2cNCiAgICAgICAgICAgIHJldHVybiBhcGkuZ2V0UHJlZnMoew0KICAgICAgICAgICAgICAgIHN5bmM6IHBhci5zeW5jIHx8IHRydWUsDQogICAgICAgICAgICAgICAga2V5OiBwYXIua2V5DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0sDQogICAgLy8g56e76Zmk5YGP5aW95pWw5o2uDQogICAgcmVtb3ZlUHJlZnM6IGZ1bmN0aW9uKHBhcikgew0KICAgICAgICBwYXIgPSBwYXIgfHwge307DQogICAgICAgIGFwaS5yZW1vdmVQcmVmcyh7DQogICAgICAgICAgICBrZXk6IHBhci5rZXkNCiAgICAgICAgfSk7DQoNCiAgICB9DQp9Ow0KLyoqDQogKgnlsIHoo4UgVUlBY3Rpb25TZWxlY3RvciDmqKHlnZcNCiAqLw0KZnVuY3Rpb24gZnVuY0FwaVNlbGVjdG9yKHBhcikgew0KICAgIHZhciBVSUFjdGlvblNlbGVjdG9yID0gYXBpLnJlcXVpcmUoJ1VJQWN0aW9uU2VsZWN0b3InKTsNCiAgICBVSUFjdGlvblNlbGVjdG9yLm9wZW4oew0KICAgICAgICBkYXRhczogcGFyLmRhdGEsDQogICAgICAgIGxheW91dDogew0KICAgICAgICAgICAgcm93OiA1LA0KICAgICAgICAgICAgY29sOiBwYXIuY29sIHx8IDMsDQogICAgICAgICAgICBoZWlnaHQ6IDMwLA0KICAgICAgICAgICAgc2l6ZTogMTQsDQogICAgICAgICAgICBzaXplQWN0aXZlOiAxNiwNCiAgICAgICAgICAgIHJvd1NwYWNpbmc6IDUsDQogICAgICAgICAgICBjb2xTcGFjaW5nOiA4LA0KICAgICAgICAgICAgbWFza0JnOiAncmdiYSgxMiw5LDUxLDAuNSknLA0KICAgICAgICAgICAgYmc6ICcjZmZmJywNCiAgICAgICAgICAgIGNvbG9yOiAnI0JCQkFCQScsDQogICAgICAgICAgICBjb2xvckFjdGl2ZTogJyMzMzMnLA0KICAgICAgICAgICAgY29sb3JTZWxlY3RlZDogJyMzMzMnDQogICAgICAgIH0sDQogICAgICAgIGFuaW1hdGlvbjogdHJ1ZSwNCiAgICAgICAgY2FuY2VsOiB7DQogICAgICAgICAgICB0ZXh0OiBwYXIuY2FuY2VsVHh0IHx8ICflj5bmtognLA0KICAgICAgICAgICAgc2l6ZTogMTUsDQogICAgICAgICAgICB3OiA2NSwNCiAgICAgICAgICAgIGg6IDQwLA0KICAgICAgICAgICAgYmc6ICdyZ2JhKDAsMCwwLDApJywNCiAgICAgICAgICAgIGJnQWN0aXZlOiAncmdiYSgwLDAsMCwwKScsDQogICAgICAgICAgICBjb2xvcjogJyM5OTknLA0KICAgICAgICAgICAgY29sb3JBY3RpdmU6ICcjOTk5Jw0KICAgICAgICB9LA0KICAgICAgICBvazogew0KICAgICAgICAgICAgdGV4dDogcGFyLm9rVHh0IHx8ICfnoa7lrponLA0KICAgICAgICAgICAgc2l6ZTogMTUsDQogICAgICAgICAgICB3OiA2NSwNCiAgICAgICAgICAgIGg6IDQwLA0KICAgICAgICAgICAgYmc6ICdyZ2JhKDAsMCwwLDApJywNCiAgICAgICAgICAgIGJnQWN0aXZlOiAncmdiYSgwLDAsMCwwKScsDQogICAgICAgICAgICBjb2xvcjogJyM3OTcxRUEnLA0KICAgICAgICAgICAgY29sb3JBY3RpdmU6ICcjNzk3MUVBJw0KICAgICAgICB9LA0KICAgICAgICB0aXRsZTogew0KICAgICAgICAgICAgdGV4dDogcGFyLnRpdGxlIHx8ICcnLA0KICAgICAgICAgICAgc2l6ZTogMTIsDQogICAgICAgICAgICBoOiA0MCwNCiAgICAgICAgICAgIGJnOiAnI2Y2ZjZmNicsDQogICAgICAgICAgICBjb2xvcjogJyMzMzMnDQogICAgICAgIH0sDQogICAgICAgIGZpeGVkT246IGFwaS5mcmFtZU5hbWUNCiAgICB9LCBmdW5jdGlvbihyZXQsIGVycikgew0KICAgICAgICBpZiAocmV0LmV2ZW50VHlwZSA9PT0gJ29rJykgew0KICAgICAgICAgICAgcGFyLmNiICYmIHR5cGVvZiBwYXIuY2IgPT09ICdmdW5jdGlvbicgJiYgcGFyLmNiKHJldCk7DQogICAgICAgIH0NCiAgICB9KTsNCn07DQovLyDkuIrkvKDlm77niYflvLnnqpflvLnnqpcNCmZ1bmN0aW9uIHVwbG9hZEltYWdlRGlhbG9nKHBhcikgew0KICAgIHdEaWFsb2cuYWN0aW9uU2hlZXQoew0KICAgICAgICBjYjogZnVuY3Rpb24ocmVzKSB7DQogICAgICAgICAgICAvLyDmi43nhacNCiAgICAgICAgICAgIGlmIChyZXMuYnV0dG9uSW5kZXggPT0gMSkgew0KICAgICAgICAgICAgICAgIHBhci5jYW1lcmFGbiAmJiB0eXBlb2YgcGFyLmNhbWVyYUZuID09PSAnZnVuY3Rpb24nICYmIHBhci5jYW1lcmFGbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8g55u45YaMDQogICAgICAgICAgICBlbHNlIGlmIChyZXMuYnV0dG9uSW5kZXggPT0gMikgew0KICAgICAgICAgICAgICAgIHBhci5hbGJ1bUZuICYmIHR5cGVvZiBwYXIuYWxidW1GbiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuYWxidW1GbigpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgLy8g5Y+W5raIDQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0pDQp9DQovKioNCiAqICDkuIrkvKDlm77niYcNCiAqKi8NCnZhciB3VXBsb2FkUGljdHVyZSA9IHsNCiAgICBjYW1lcmE6IGZ1bmN0aW9uKHBhcikgew0KICAgICAgICBwYXIgPSBwYXIgfHwge307DQogICAgICAgIGFwaS5nZXRQaWN0dXJlKHsNCiAgICAgICAgICAgIHNvdXJjZVR5cGU6ICdjYW1lcmEnLA0KICAgICAgICAgICAgZW5jb2RpbmdUeXBlOiAnanBnJywNCiAgICAgICAgICAgIG1lZGlhVmFsdWU6ICdwaWMnLA0KICAgICAgICAgICAgZGVzdGluYXRpb25UeXBlOiBwYXIudHlwZSB8fCAndXJsJywNCiAgICAgICAgICAgIGFsbG93RWRpdDogcGFyLmFsbG93RWRpdCB8fCB0cnVlLA0KICAgICAgICAgICAgcXVhbGl0eTogcGFyLnF1YWxpdHkgfHwgNjAsDQogICAgICAgICAgICB0YXJnZXRXaWR0aDogcGFyLnRhcmdldFdpZHRoIHx8ICcnLA0KICAgICAgICAgICAgdGFyZ2V0SGVpZ2h0OiBwYXIudGFyZ2V0SGVpZ2h0IHx8ICcnLA0KICAgICAgICAgICAgc2F2ZVRvUGhvdG9BbGJ1bTogcGFyLnNhdmVUb1Bob3RlIHx8IHRydWUNCiAgICAgICAgfSwgZnVuY3Rpb24ocmV0LCBlcnIpIHsNCiAgICAgICAgICAgIC8vIGFsZXJ0KEpTT04uc3RyaW5naWZ5KHJldCkpOw0KICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmV0KSk7DQogICAgICAgICAgICBpZiAocmV0LmRhdGEgfHwgcmV0LmJhc2U2NERhdGEpIHsNCiAgICAgICAgICAgICAgICBwYXIuY2IgJiYgdHlwZW9mIHBhci5jYiA9PT0gJ2Z1bmN0aW9uJyAmJiBwYXIuY2IocmV0KTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+acquaLjeeFpycpDQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgfSwNCiAgICBhbGJ1bTogZnVuY3Rpb24ocGFyKSB7DQogICAgICAgIHZhciBVSUFsYnVtQnJvd3NlciA9IGFwaS5yZXF1aXJlKCJVSUFsYnVtQnJvd3NlciIpOw0KICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgICBVSUFsYnVtQnJvd3Nlci5vcGVuKHsNCiAgICAgICAgICAgIG1heDogcGFyLm1heCB8fCA5LA0KICAgICAgICAgICAgdHlwZTogcGFyLnR5cGUgfHwgJ2ltYWdlJywNCiAgICAgICAgICAgIGlzT3BlblByZXZpZXc6IHRydWUsDQogICAgICAgICAgICBjbGFzc2lmeTogdHJ1ZSwNCiAgICAgICAgICAgIHNlbGVjdGVkQWxsOiB0cnVlLA0KICAgICAgICAgICAgc3R5bGVzOiB7DQogICAgICAgICAgICAgICAgYmc6ICcjMDAwMDAwJywNCiAgICAgICAgICAgICAgICBtYXJrOiB7DQogICAgICAgICAgICAgICAgICAgIGljb246ICcnLA0KICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcF9yaWdodCcsDQogICAgICAgICAgICAgICAgICAgIHNpemU6IDIwDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBuYXY6IHsNCiAgICAgICAgICAgICAgICAgICAgYmc6ICcjMDAwJywNCiAgICAgICAgICAgICAgICAgICAgdGl0bGVDb2xvcjogJyNmZmZmZmYnLA0KICAgICAgICAgICAgICAgICAgICB0aXRsZVNpemU6IDE4LA0KICAgICAgICAgICAgICAgICAgICBjYW5jZWxDb2xvcjogJyMwMGZmMDAnLA0KICAgICAgICAgICAgICAgICAgICBjYW5jZWxTaXplOiAxNiwNCiAgICAgICAgICAgICAgICAgICAgZmluaXNoQ29sb3I6ICcjMDBmZjAwJywNCiAgICAgICAgICAgICAgICAgICAgZmluaXNoU2l6ZTogMTYNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgcm90YXRpb246IGZhbHNlDQogICAgICAgIH0sIGZ1bmN0aW9uKHJldCwgZXJyKSB7DQogICAgICAgICAgICAvLyBhbGVydChKU09OLnN0cmluZ2lmeShyZXQpKQ0KICAgICAgICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkocmV0KSk7DQogICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeShlcnIpKTsNCiAgICAgICAgICAgIGlmIChyZXQuZXZlbnRUeXBlID09ICdjb25maXJtJyAmJiByZXQubGlzdC5sZW5ndGgpIHsNCiAgICAgICAgICAgICAgICBfdGhpcy50cmFuc1BhdGgocmV0Lmxpc3QsIHBhcik7DQogICAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgfSwNCiAgICAvLyDovazmjaLlm77niYfot6/lvoTln47nu53lr7not6/lvoQNCiAgICB0cmFuc1BhdGg6IGZ1bmN0aW9uKHBhdGhMaXMsIHBhcikgew0KICAgICAgICB2YXIgVUlBbGJ1bUJyb3dzZXIgPSBhcGkucmVxdWlyZSgiVUlBbGJ1bUJyb3dzZXIiKTsNCiAgICAgICAgdmFyIGFyciA9IFtdOw0KICAgICAgICBwYXRoTGlzLmZvckVhY2goZnVuY3Rpb24odikgew0KICAgICAgICAgICAgICAgIFVJQWxidW1Ccm93c2VyLnRyYW5zUGF0aCh7DQogICAgICAgICAgICAgICAgICAgIHBhdGg6IHYucGF0aA0KICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykgew0KICAgICAgICAgICAgICAgICAgICBpZiAocmVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBhcnIucHVzaChyZXMucGF0aCkNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkoYXJyKSkNCiAgICAgICAgcGFyLmNiICYmIHR5cGVvZiBwYXIuY2IgPT09ICdmdW5jdGlvbicgJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHBhci5jYihhcnIpDQogICAgICAgIH0sIDMwMCk7DQogICAgfQ0KfTsNCi8qKg0KICogIOmihOiniOWbvueJhyBwaG90b0Jyb3dzZXINCiAqLw0KdmFyIHdQaG90b0Jyb3dzZXIgPSB7DQogICAgcGhvdG9Ccm93c2VyOiAnJywNCiAgICBpbml0OiBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy5waG90b0Jyb3dzZXIgPSBhcGkucmVxdWlyZSgncGhvdG9Ccm93c2VyJyk7DQogICAgfSwNCiAgICBvcGVuOiBmdW5jdGlvbihwYXIpIHsNCiAgICAgICAgdGhpcy5pbml0KCk7DQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICAgIHRoaXMucGhvdG9Ccm93c2VyLm9wZW4oew0KICAgICAgICAgICAgaW1hZ2VzOiBwYXIuaW1nTGlzdCB8fCBbXSwNCiAgICAgICAgICAgIHBsYWNlaG9sZGVySW1nOiBwYXIucGxhY2VJbWcgfHwgJycsDQogICAgICAgICAgICBiZ0NvbG9yOiBwYXIuYmcgfHwgJyMwMDAnLA0KICAgICAgICAgICAgYWN0aXZlSW5kZXg6IHBhci5hY3RpdmVJbmRleCB8fCAwLA0KICAgICAgICAgICAgem9vbUVuYWJsZWQ6IHBhci56b29tIHx8IHRydWUsDQogICAgICAgICAgICBtb2RlOiBwYXIubW9kZSB8fCAxLA0KICAgICAgICB9LCBmdW5jdGlvbihyZXQsIGVycikgew0KICAgICAgICAgICAgaWYgKHJldC5ldmVudFR5cGUgPT0gJ2NsaWNrJykgew0KICAgICAgICAgICAgICAgIHBhci5jYiAmJiB0eXBlb2YgcGFyLmNiID09PSAnZnVuY3Rpb24nICYmIHBhci5jYigpOw0KICAgICAgICAgICAgICAgIF90aGlzLnBob3RvQnJvd3Nlci5jbG9zZSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGNsb3NlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgdGhpcy5pbml0KCk7DQogICAgICAgIHRoaXMucGhvdG9Ccm93c2VyLmNsb3NlKCkNCiAgICB9DQp9Ow0K"></script>
<script>
    apiready = function() {
        $api.fixStatusBar($('.header')[0]);
    new Vue({
            el: '#wrap',
            data: {
                phone: '',
                code: '',
                obtain: '获取验证码',
                default_obtain: true,
                count: '',
                timer: null,
                verification: '',
                InfoPhone:'',
            },
            methods: {
                getUserInfo: function() {
                     var _this = this
                    _this.InfoPhone = wPref.getPrefs({
                        key:'InfoPhone'
                    })
                    this.InfoPhone = this.InfoPhone ? JSON.parse(this.InfoPhone) : {};
                    console.log(JSON.parse(_this.InfoPhone).employeeid)
                },
                obtainClick: function() {
                    var _this = this;
                    const phoneExp = /^1[3456789]\d{9}$/;
                    if ((!phoneExp.test(_this.phone)) || _this.phone == "") {
                       wDialog.toast({
                           msg:'请输入正确号码'
                       })
                    } else {
                        const TIME_COUNT = 60;
                        if (!_this.timer) {
                            _this.count = TIME_COUNT;
                            _this.default_obtain = false;
                            _this.timer = setInterval(() => {
                                if (_this.count > 0 && _this.count <= TIME_COUNT) {
                                    _this.count--;
                                } else {
                                    _this.default_obtain = true;
                                    clearInterval(this.timer);
                                    _this.timer = null;
                                }
                            }, 1000)
                        };
                        wApiAjax({
                            url:'phoneauth/authen',
                            dataType: "json",
                            type: 'POST',
                            withCredentials: true,
                            data: {
                                account: JSON.parse(_this.InfoPhone).account,
                                employeeid:JSON.parse(_this.InfoPhone).employeeid,
                                phone: _this.phone,
                                type:1
                            },
                            success: function(res) {
                                console.log(JSON.stringify(res))
                                if(res.code==-3){
                                    wDialog.toast({
                                        msg:res.msg
                                    })
                                }
                                if(res.code==4){
                                    _this.verification = res.random
                                }

                            }
                        })

                    }
                },
                authentication: function() {
                    var self = this;
                    var phoneExp = /^1[3456789]\d{9}$/;
                    if (self.phone == "" || self.phone == null || self.phone == undefined) {
                       wDialog.toast({
                           msg:'请输入号码'
                       })
                        return;
                    } else if (!phoneExp.test(self.phone)) {
                       wDialog.toast({
                           msg:'请输入正确号码'
                       })
                        return;
                    };
                    if (self.code == "" || self.code == null || self.code == undefined) {
                       wDialog.toast({
                           msg:'请输入验证码'
                       })
                        return;
                    };
                    if (self.code == self.verification || phoneExp.test(self.phone)) {
                        wApiAjax({
                            method: "post",
                            url:'phoneauth/bind',
                            data: {
                                account: JSON.parse(self.InfoPhone).account,
                                employeeid:JSON.parse(self.InfoPhone).employeeid,
                                phone: self.phone,
                                authcode: self.code,
                                type:1   //发送短信类型:1-手机号验证，2-微信号查看
                            },
                            success: function(res){
                                console.log(res)
                                if (res.code == 5) {
                                   wDialog.toast({
                                       msg:res.msg
                                   })
                                   api.closeWin({
                                       name: 'phonerz'
                                   });
                                }
                                if (res.code == 2) {
                                    wDialog.toast({
                                        msg:res.msg
                                    })
                                }

                            }
                        })
                    }
                },
                back() {
                    api.closeWin({
                        name: 'phonerz'
                    });
                }
            },
            mounted() {
                this.getUserInfo();
            }
        })
        }
</script>

</html>
